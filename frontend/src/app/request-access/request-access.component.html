<div class="flex-container align-items-center justify-content-center">
    <h1>Request access to dataset</h1>
    <div *ngIf="dataset !== undefined">
        <p-table [value]="dataset | datasetToSortedEntries">
            <ng-template pTemplate="body" let-datasetInfo>
                <tr>
                    <td>
                        <b>{{ fieldKeyToLabel[datasetInfo.key] }}</b>
                    </td>
                    <td *ngIf="['name', 'accessibility'].includes(datasetInfo.key)">{{ datasetInfo.value }}</td>
                    <td *ngIf="datasetInfo.key === 'dua_file_name'">
                        <p-button (click)="downloadDua()">{{ datasetInfo.value }}</p-button>
                        <p-checkbox label="I accept the DUA" [(ngModel)]="acceptDua" [binary]="true"></p-checkbox>
                    </td>
                    <td *ngIf="datasetInfo.key === 'scc_file_name'">
                        <p-button (click)="downloadScc()">{{ datasetInfo.value }}</p-button>
                        <ng-container *ngIf="dataset.institution_scc_accepted === true"
                            >Your institution has accepted the SCC</ng-container
                        >
                        <ng-container *ngIf="dataset.institution_scc_accepted === false"
                            >Your institution has rejected the SCC</ng-container
                        >
                        <ng-container *ngIf="dataset.institution_scc_accepted === undefined"
                            >Institution has not yet accepted the SCC</ng-container
                        >
                    </td>
                </tr>
            </ng-template> </p-table
        ><br />
        <div *ngIf="dataset.accessibility !== 'PUBLIC'">
            <div *ngIf="userInfo === null">
                <div>not public and not logged in</div>
                <p-button (click)="gotoLogin()">Login</p-button>
                <div>Don't have an account yet?</div>
                <p-button (click)="gotoRegister()">Register</p-button>
            </div>
            <div *ngIf="userInfo !== null && userInfo !== undefined">
                <div *ngIf="userInfo.email_confirmed_at === null">
                    You need to verify your email. Click the link in the welcome email you received.
                </div>
                <div *ngIf="userInfo.email_confirmed_at !== null && userInfo.approved_at === null">
                    Waiting for approval by admin
                </div>
            </div>
        </div>
        <div *ngIf="!acceptDua">You need to accept the DUA before requesting access</div>
        <div>
            <p-button [disabled]="(dataset.institution_scc_accepted === false || !acceptDua)">Request access</p-button>
        </div>
    </div>
</div>
