<h1>Access Requests</h1>
<p-table [value]="userDatasets">
    <ng-template pTemplate="header">
        <tr>
            <th>User ID</th>
            <th>User email</th>
            <th>Dataset ID</th>
            <th>Access requested at</th>
            <th>User accepted DUA at</th>
            <th>Email sent to admin at</th>
            <th>Access granted by admin at</th>
            <th>DELPHI share created at</th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-userDataset>
        <tr>
            <td>
                <a href="/manage/admin/users/{{ userDataset.user_id }}">{{ userDataset.user_id }}</a>
            </td>
            <td>{{ userDataset.user_email }}</td>
            <td>
                <a href="/manage/admin/datasets/{{ userDataset.dataset_id }}">{{ userDataset.dataset_id }}</a>
            </td>
            <td>{{ userDataset.access_requested_at | datetime }}</td>
            <td>{{ userDataset.user_accepted_dua_at | datetime }}</td>
            <td>{{ userDataset.email_sent_to_admin_at | datetime }}</td>
            <td>
                <ng-container *ngIf="userDataset.access_granted_by_admin_at">{{
                    userDataset.access_granted_by_admin_at | datetime
                }}</ng-container>
                <p-button
                    *ngIf="!userDataset.access_granted_by_admin_at"
                    label="Grant access"
                    (onClick)="grantAccess(userDataset)"
                    styleClass="p-button-success"
                ></p-button>
            </td>
            <td>{{ userDataset.delphi_share_created_at | datetime }}</td>
        </tr>
    </ng-template>
</p-table>
